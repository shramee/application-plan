var app,appData;appData=localStorage.getItem("appData"),appData=appData?JSON.parse(appData):[],app=function(a){return a(".wrap:first").fadeIn(350),{s:{},i:null,module:{},saveAppData:function(){return localStorage.setItem("appData",JSON.stringify(appData))},init:function(){return app.initVars(),app.initEvents(),app.modules(),app.sortable()},sortable:function(){return a(".multi-list").sortable({connectWith:".multi-chosen"}),a(".multi-chosen").sortable({connectWith:".multi-list"}),a(".single-list").sortable({connectWith:".single-chosen"}),a(".single-chosen").sortable({connectWith:".single-list"})},initVars:function(){return app.$mods=a(".modules"),app.$n=a("#module"),app.$tax=a(".tax .list"),app.$meta=a(".meta .list"),app.$multi=a(".multi .list"),app.$single=a(".single .list")},initEvents:function(){return app.$mods.on("click",".module",function(){var b;return b=a(this),app.i=b.attr("i"),app.module=appData[app.i],app.initModule()})},switchS:function(b){var c;if(c=a("#"+b),!c.is(":visible"))return a(".wrap").fadeOut(350),c.fadeIn(350)},initModule:function(){var b,c,d,e,f,g,h,i,j,k,l;app.switchS("module"),f=app.module,a("#name").val(f.name),app.$tax.html(""),app.$meta.html(""),app.$multi.html(""),app.$single.html(""),h=f.Taxo,b=function(a,b){return app.$tax.append('<span class="btn pu-bg field">'+a+"</span>"),app.$multi.append('<div data-name="'+a+'" class="btn pu-bg field"><span class="field-name">'+a+'</span> : <span class="field-value">'+b+"</span></div>"),app.$single.append('<div data-name="'+a+'" class="btn pu-bg field"><span class="field-name">'+a+'</span> : <span class="field-value">'+b+"</span></div>")};for(g in h)l=h[g],b(g,l);i=f.Meta,c=function(a,b){return app.$meta.append('<span class="btn pu-bg field">'+a+"</span>"),app.$multi.append('<div data-name="'+a+'" class="btn pu-bg field"><span class="field-name">'+a+'</span> : <span class="field-value">'+b+"</span></div>"),app.$single.append('<div data-name="'+a+'" class="btn pu-bg field"><span class="field-name">'+a+'</span> : <span class="field-value">'+b+"</span></div>")};for(g in i)l=i[g],c(g,l);j=f.MultiView,d=function(a,b){return app.$multi.children('[data-name="'+a+'"]').appendTo(app.$multi.siblings(".chosen"))};for(g in j)l=j[g],d(g,l);k=f.SingleView,e=function(a,b){return app.$single.children('[data-name="'+a+'"]').appendTo(app.$single.siblings(".chosen"))};for(g in k)l=k[g],e(g,l);return a(".multi-list, .multi-chosen, .single-list, .single-chosen").each(function(){return a(this).sortable("refresh")})},newModule:function(){return app.i=null,app.module={name:"",Taxo:{},Meta:{},MultiView:{},SingleView:{}},app.initModule()},modules:function(){var a,b,c;if(app.switchS("modules"),appData.length){app.$mods.html(""),c=[];for(a in appData)b=appData[a],c.push(function(a,b){return app.$mods.append('<a i="'+a+'" class="btn pu-bg module">'+b.name+"</a>")}(a,b));return c}},modTaxo:function(){return app.insertFieldCallback=function(a,b){return app.module.Taxo[a]=b},app.insertFieldDlog("New Taxonomy")},modMeta:function(){return app.insertFieldCallback=function(a,b){return app.module.Meta[a]=b},app.insertFieldDlog("New Metadata field")},insertFieldDlog:function(b){return null==b&&(b=""),a("#field-name").val(""),a("#field-value").val(""),a(".add-field").fadeIn().find("h2").html(b)},insertField:function(){var b,c,d;return b=a(".add-field"),c=a("#field-name").val(),d=a("#field-value").val(),c?d?(app.insertFieldCallback(c,d),app.initModule(),b.fadeOut()):alert("Please type an example value for the "+b.find("h2").html()+", Like Kerala for City or alex@example.com for Email"):alert("Please type name for the "+b.find("h2").html()+", Like City/Email for a person.")},save:function(){return app.module.name=a("#name").val(),null===app.i?appData.push(app.module):appData[app.i]=app.module,app.saveAppData(),app.modules()}}}(jQuery),app.init(),window.beforeunload=app.saveAppData;